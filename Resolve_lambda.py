import time
from utils.common import *

print("решение системы { Eq6, Eq8, Eq9, Eq10 } относительно λ1, λ2, λ3, λ4")

Eq6_str = "-M_φ + 0.5*m*(2*C_mz*(sin(α(t))*cos(γ(t)) + sin(β(t))*sin(γ(t))*cos(α(t)))*sin(ψ(t)) - 2*C_mz*cos(α(t))*cos(β(t))*cos(ψ(t)))*(C_mz*(sin(α(t))*cos(γ(t)) + sin(β(t))*sin(γ(t))*cos(α(t)))*(sin(β(t))*Derivative(α(t), (t, 2)) + sin(ψ(t))*Derivative(φ(t), (t, 2)) + cos(β(t))*Derivative(α(t), t)*Derivative(β(t), t) + cos(ψ(t))*Derivative(φ(t), t)*Derivative(ψ(t), t) + Derivative(γ(t), (t, 2))) + C_mz*(sin(β(t))*Derivative(α(t), t) + sin(ψ(t))*Derivative(φ(t), t) + Derivative(γ(t), t))*(-sin(α(t))*sin(β(t))*sin(γ(t))*Derivative(α(t), t) - sin(α(t))*sin(γ(t))*Derivative(γ(t), t) + sin(β(t))*cos(α(t))*cos(γ(t))*Derivative(γ(t), t) + sin(γ(t))*cos(α(t))*cos(β(t))*Derivative(β(t), t) + cos(α(t))*cos(γ(t))*Derivative(α(t), t)) + C_mz*(-sin(γ(t))*cos(β(t))*Derivative(α(t), t) + cos(γ(t))*Derivative(β(t), t) + cos(ψ(t))*Derivative(φ(t), t))*sin(α(t))*cos(β(t))*Derivative(α(t), t) + C_mz*(-sin(γ(t))*cos(β(t))*Derivative(α(t), t) + cos(γ(t))*Derivative(β(t), t) + cos(ψ(t))*Derivative(φ(t), t))*sin(β(t))*cos(α(t))*Derivative(β(t), t) - C_mz*(sin(β(t))*sin(γ(t))*Derivative(α(t), t)*Derivative(β(t), t) - sin(γ(t))*cos(β(t))*Derivative(α(t), (t, 2)) - sin(γ(t))*Derivative(β(t), t)*Derivative(γ(t), t) - sin(ψ(t))*Derivative(φ(t), t)*Derivative(ψ(t), t) - cos(β(t))*cos(γ(t))*Derivative(α(t), t)*Derivative(γ(t), t) + cos(γ(t))*Derivative(β(t), (t, 2)) + cos(ψ(t))*Derivative(φ(t), (t, 2)))*cos(α(t))*cos(β(t)) + Derivative(y(t), (t, 2))) + 0.5*m*(2*C_mz*(-sin(α(t))*sin(β(t))*sin(γ(t)) + cos(α(t))*cos(γ(t)))*sin(ψ(t)) + 2*C_mz*sin(α(t))*cos(β(t))*cos(ψ(t)))*(C_mz*(-sin(α(t))*sin(β(t))*sin(γ(t)) + cos(α(t))*cos(γ(t)))*(sin(β(t))*Derivative(α(t), (t, 2)) + sin(ψ(t))*Derivative(φ(t), (t, 2)) + cos(β(t))*Derivative(α(t), t)*Derivative(β(t), t) + cos(ψ(t))*Derivative(φ(t), t)*Derivative(ψ(t), t) + Derivative(γ(t), (t, 2))) + C_mz*(sin(β(t))*Derivative(α(t), t) + sin(ψ(t))*Derivative(φ(t), t) + Derivative(γ(t), t))*(-sin(α(t))*sin(β(t))*cos(γ(t))*Derivative(γ(t), t) - sin(α(t))*sin(γ(t))*cos(β(t))*Derivative(β(t), t) - sin(α(t))*cos(γ(t))*Derivative(α(t), t) - sin(β(t))*sin(γ(t))*cos(α(t))*Derivative(α(t), t) - sin(γ(t))*cos(α(t))*Derivative(γ(t), t)) - C_mz*(-sin(γ(t))*cos(β(t))*Derivative(α(t), t) + cos(γ(t))*Derivative(β(t), t) + cos(ψ(t))*Derivative(φ(t), t))*sin(α(t))*sin(β(t))*Derivative(β(t), t) + C_mz*(-sin(γ(t))*cos(β(t))*Derivative(α(t), t) + cos(γ(t))*Derivative(β(t), t) + cos(ψ(t))*Derivative(φ(t), t))*cos(α(t))*cos(β(t))*Derivative(α(t), t) + C_mz*(sin(β(t))*sin(γ(t))*Derivative(α(t), t)*Derivative(β(t), t) - sin(γ(t))*cos(β(t))*Derivative(α(t), (t, 2)) - sin(γ(t))*Derivative(β(t), t)*Derivative(γ(t), t) - sin(ψ(t))*Derivative(φ(t), t)*Derivative(ψ(t), t) - cos(β(t))*cos(γ(t))*Derivative(α(t), t)*Derivative(γ(t), t) + cos(γ(t))*Derivative(β(t), (t, 2)) + cos(ψ(t))*Derivative(φ(t), (t, 2)))*sin(α(t))*cos(β(t)) + Derivative(x(t), (t, 2))) + 0.5*m*(-2*C_mz*sin(β(t))*cos(ψ(t)) - 2*C_mz*sin(γ(t))*sin(ψ(t))*cos(β(t)))*(C_mz*(sin(β(t))*Derivative(α(t), t) + sin(ψ(t))*Derivative(φ(t), t) + Derivative(γ(t), t))*sin(β(t))*sin(γ(t))*Derivative(β(t), t) - C_mz*(sin(β(t))*Derivative(α(t), t) + sin(ψ(t))*Derivative(φ(t), t) + Derivative(γ(t), t))*cos(β(t))*cos(γ(t))*Derivative(γ(t), t) - C_mz*(-sin(γ(t))*cos(β(t))*Derivative(α(t), t) + cos(γ(t))*Derivative(β(t), t) + cos(ψ(t))*Derivative(φ(t), t))*cos(β(t))*Derivative(β(t), t) - C_mz*(sin(β(t))*Derivative(α(t), (t, 2)) + sin(ψ(t))*Derivative(φ(t), (t, 2)) + cos(β(t))*Derivative(α(t), t)*Derivative(β(t), t) + cos(ψ(t))*Derivative(φ(t), t)*Derivative(ψ(t), t) + Derivative(γ(t), (t, 2)))*sin(γ(t))*cos(β(t)) - C_mz*(sin(β(t))*sin(γ(t))*Derivative(α(t), t)*Derivative(β(t), t) - sin(γ(t))*cos(β(t))*Derivative(α(t), (t, 2)) - sin(γ(t))*Derivative(β(t), t)*Derivative(γ(t), t) - sin(ψ(t))*Derivative(φ(t), t)*Derivative(ψ(t), t) - cos(β(t))*cos(γ(t))*Derivative(α(t), t)*Derivative(γ(t), t) + cos(γ(t))*Derivative(β(t), (t, 2)) + cos(ψ(t))*Derivative(φ(t), (t, 2)))*sin(β(t))) + 0.5*m*(-C_mz*(sin(β(t))*Derivative(α(t), t) + sin(ψ(t))*Derivative(φ(t), t) + Derivative(γ(t), t))*sin(γ(t))*cos(β(t)) - C_mz*(-sin(γ(t))*cos(β(t))*Derivative(α(t), t) + cos(γ(t))*Derivative(β(t), t) + cos(ψ(t))*Derivative(φ(t), t))*sin(β(t)))*(2*C_mz*sin(β(t))*sin(γ(t))*sin(ψ(t))*Derivative(β(t), t) + 2*C_mz*sin(β(t))*sin(ψ(t))*Derivative(ψ(t), t) - 2*C_mz*sin(γ(t))*cos(β(t))*cos(ψ(t))*Derivative(ψ(t), t) - 2*C_mz*sin(ψ(t))*cos(β(t))*cos(γ(t))*Derivative(γ(t), t) - 2*C_mz*cos(β(t))*cos(ψ(t))*Derivative(β(t), t)) + 0.5*m*(C_mz*(sin(α(t))*cos(γ(t)) + sin(β(t))*sin(γ(t))*cos(α(t)))*(sin(β(t))*Derivative(α(t), t) + sin(ψ(t))*Derivative(φ(t), t) + Derivative(γ(t), t)) - C_mz*(-sin(γ(t))*cos(β(t))*Derivative(α(t), t) + cos(γ(t))*Derivative(β(t), t) + cos(ψ(t))*Derivative(φ(t), t))*cos(α(t))*cos(β(t)) + Derivative(y(t), t))*(2*C_mz*(sin(α(t))*cos(γ(t)) + sin(β(t))*sin(γ(t))*cos(α(t)))*cos(ψ(t))*Derivative(ψ(t), t) + 2*C_mz*(-sin(α(t))*sin(β(t))*sin(γ(t))*Derivative(α(t), t) - sin(α(t))*sin(γ(t))*Derivative(γ(t), t) + sin(β(t))*cos(α(t))*cos(γ(t))*Derivative(γ(t), t) + sin(γ(t))*cos(α(t))*cos(β(t))*Derivative(β(t), t) + cos(α(t))*cos(γ(t))*Derivative(α(t), t))*sin(ψ(t)) + 2*C_mz*sin(α(t))*cos(β(t))*cos(ψ(t))*Derivative(α(t), t) + 2*C_mz*sin(β(t))*cos(α(t))*cos(ψ(t))*Derivative(β(t), t) + 2*C_mz*sin(ψ(t))*cos(α(t))*cos(β(t))*Derivative(ψ(t), t)) + 0.5*m*(C_mz*(-sin(α(t))*sin(β(t))*sin(γ(t)) + cos(α(t))*cos(γ(t)))*(sin(β(t))*Derivative(α(t), t) + sin(ψ(t))*Derivative(φ(t), t) + Derivative(γ(t), t)) + C_mz*(-sin(γ(t))*cos(β(t))*Derivative(α(t), t) + cos(γ(t))*Derivative(β(t), t) + cos(ψ(t))*Derivative(φ(t), t))*sin(α(t))*cos(β(t)) + Derivative(x(t), t))*(2*C_mz*(-sin(α(t))*sin(β(t))*sin(γ(t)) + cos(α(t))*cos(γ(t)))*cos(ψ(t))*Derivative(ψ(t), t) + 2*C_mz*(-sin(α(t))*sin(β(t))*cos(γ(t))*Derivative(γ(t), t) - sin(α(t))*sin(γ(t))*cos(β(t))*Derivative(β(t), t) - sin(α(t))*cos(γ(t))*Derivative(α(t), t) - sin(β(t))*sin(γ(t))*cos(α(t))*Derivative(α(t), t) - sin(γ(t))*cos(α(t))*Derivative(γ(t), t))*sin(ψ(t)) - 2*C_mz*sin(α(t))*sin(β(t))*cos(ψ(t))*Derivative(β(t), t) - 2*C_mz*sin(α(t))*sin(ψ(t))*cos(β(t))*Derivative(ψ(t), t) + 2*C_mz*cos(α(t))*cos(β(t))*cos(ψ(t))*Derivative(α(t), t)) - r*λ3*(sin(α(t))*sin(β(t))*sin(γ(t))*sin(ψ(t)) - sin(α(t))*cos(β(t))*cos(ψ(t)) - sin(ψ(t))*cos(α(t))*cos(γ(t))) - r*λ4*(-sin(α(t))*sin(ψ(t))*cos(γ(t)) - sin(β(t))*sin(γ(t))*sin(ψ(t))*cos(α(t)) + cos(α(t))*cos(β(t))*cos(ψ(t))) + (1.0*l**2*m + 0.25*m*r**2)*(sin(β(t))*Derivative(α(t), t) + sin(ψ(t))*Derivative(φ(t), t) + Derivative(γ(t), t))*cos(ψ(t))*Derivative(ψ(t), t) - (1.0*l**2*m + 0.25*m*r**2)*(-sin(γ(t))*cos(β(t))*Derivative(α(t), t) + cos(γ(t))*Derivative(β(t), t) + cos(ψ(t))*Derivative(φ(t), t))*sin(ψ(t))*Derivative(ψ(t), t) + (1.0*l**2*m + 0.25*m*r**2)*(sin(β(t))*Derivative(α(t), (t, 2)) + sin(ψ(t))*Derivative(φ(t), (t, 2)) + cos(β(t))*Derivative(α(t), t)*Derivative(β(t), t) + cos(ψ(t))*Derivative(φ(t), t)*Derivative(ψ(t), t) + Derivative(γ(t), (t, 2)))*sin(ψ(t)) + (1.0*l**2*m + 0.25*m*r**2)*(sin(β(t))*sin(γ(t))*Derivative(α(t), t)*Derivative(β(t), t) - sin(γ(t))*cos(β(t))*Derivative(α(t), (t, 2)) - sin(γ(t))*Derivative(β(t), t)*Derivative(γ(t), t) - sin(ψ(t))*Derivative(φ(t), t)*Derivative(ψ(t), t) - cos(β(t))*cos(γ(t))*Derivative(α(t), t)*Derivative(γ(t), t) + cos(γ(t))*Derivative(β(t), (t, 2)) + cos(ψ(t))*Derivative(φ(t), (t, 2)))*cos(ψ(t))"
Eq8_str =  "0.666666666666667*M*R**2*(sin(ε(t))*Derivative(δ(t), t) + Derivative(τ(t), t))*cos(ε(t))*Derivative(ε(t), t) - 0.666666666666667*M*R**2*(sin(ε(t))*cos(τ(t))*Derivative(δ(t), t) + sin(τ(t))*Derivative(ε(t), t))*sin(ε(t))*sin(τ(t))*Derivative(τ(t), t) + 0.666666666666667*M*R**2*(sin(ε(t))*cos(τ(t))*Derivative(δ(t), t) + sin(τ(t))*Derivative(ε(t), t))*cos(ε(t))*cos(τ(t))*Derivative(ε(t), t) + 0.666666666666667*M*R**2*(-sin(τ(t))*cos(ε(t))*Derivative(δ(t), t) + cos(τ(t))*Derivative(ε(t), t))*sin(ε(t))*sin(τ(t))*Derivative(ε(t), t) - 0.666666666666667*M*R**2*(-sin(τ(t))*cos(ε(t))*Derivative(δ(t), t) + cos(τ(t))*Derivative(ε(t), t))*cos(ε(t))*cos(τ(t))*Derivative(τ(t), t) + 0.666666666666667*M*R**2*(sin(ε(t))*Derivative(δ(t), (t, 2)) + cos(ε(t))*Derivative(δ(t), t)*Derivative(ε(t), t) + Derivative(τ(t), (t, 2)))*sin(ε(t)) - 0.666666666666667*M*R**2*(sin(ε(t))*sin(τ(t))*Derivative(δ(t), t)*Derivative(ε(t), t) - sin(τ(t))*cos(ε(t))*Derivative(δ(t), (t, 2)) - sin(τ(t))*Derivative(ε(t), t)*Derivative(τ(t), t) - cos(ε(t))*cos(τ(t))*Derivative(δ(t), t)*Derivative(τ(t), t) + cos(τ(t))*Derivative(ε(t), (t, 2)))*sin(τ(t))*cos(ε(t)) + 0.666666666666667*M*R**2*(-sin(ε(t))*sin(τ(t))*Derivative(δ(t), t)*Derivative(τ(t), t) + sin(ε(t))*cos(τ(t))*Derivative(δ(t), (t, 2)) + sin(τ(t))*Derivative(ε(t), (t, 2)) + cos(ε(t))*cos(τ(t))*Derivative(δ(t), t)*Derivative(ε(t), t) + cos(τ(t))*Derivative(ε(t), t)*Derivative(τ(t), t))*sin(ε(t))*cos(τ(t)) - 0.5*M_p*R_p**2*(sin(ε(t))*cos(τ(t))*Derivative(δ(t), t) + sin(τ(t))*Derivative(ε(t), t))*sin(ε(t))*sin(τ(t))*Derivative(τ(t), t) + 0.5*M_p*R_p**2*(sin(ε(t))*cos(τ(t))*Derivative(δ(t), t) + sin(τ(t))*Derivative(ε(t), t))*cos(ε(t))*cos(τ(t))*Derivative(ε(t), t) + 0.5*M_p*R_p**2*(-sin(ε(t))*sin(τ(t))*Derivative(δ(t), t)*Derivative(τ(t), t) + sin(ε(t))*cos(τ(t))*Derivative(δ(t), (t, 2)) + sin(τ(t))*Derivative(ε(t), (t, 2)) + cos(ε(t))*cos(τ(t))*Derivative(δ(t), t)*Derivative(ε(t), t) + cos(τ(t))*Derivative(ε(t), t)*Derivative(τ(t), t))*sin(ε(t))*cos(τ(t)) + R*λ1*sin(ε(t)) - R*λ2*sin(τ(t))*cos(ε(t)) - R*λ3*(-sqrt(2)*sin(ε(t) + pi/4)*sin(α(t))*sin(γ(t))*sin(ε(t))*cos(τ(t))**2 + sqrt(2)*sin(ε(t) + pi/4)*sin(β(t))*sin(ε(t))*cos(α(t))*cos(γ(t))*cos(τ(t))**2 + sin(α(t))*sin(γ(t))*cos(τ(t))**2 - sin(α(t))*sin(γ(t)) - sin(β(t))*cos(α(t))*cos(γ(t))*cos(τ(t))**2 + sin(β(t))*cos(α(t))*cos(γ(t)) - sqrt(2)*sin(δ(t))*sin(τ(t))*cos(ε(t) + pi/4)*cos(β(t))*cos(γ(t))*cos(τ(t)) + sqrt(2)*sin(ε(t))*cos(ε(t) + pi/4)*cos(β(t))*cos(γ(t))*cos(δ(t))*cos(τ(t))**2) - R*λ4*(sqrt(2)*sin(ε(t) + pi/4)*sin(α(t))*sin(β(t))*sin(ε(t))*cos(γ(t))*cos(τ(t))**2 + sqrt(2)*sin(ε(t) + pi/4)*sin(γ(t))*sin(ε(t))*cos(α(t))*cos(τ(t))**2 - sin(α(t))*sin(β(t))*cos(γ(t))*cos(τ(t))**2 + sin(α(t))*sin(β(t))*cos(γ(t)) - sin(γ(t))*cos(α(t))*cos(τ(t))**2 + sin(γ(t))*cos(α(t)) + sqrt(2)*sin(δ(t))*sin(ε(t))*cos(ε(t) + pi/4)*cos(β(t))*cos(γ(t))*cos(τ(t))**2 + sqrt(2)*sin(τ(t))*cos(ε(t) + pi/4)*cos(β(t))*cos(γ(t))*cos(δ(t))*cos(τ(t)))"
Eq9_str = "-0.666666666666667*M*R**2*(sin(ε(t))*Derivative(δ(t), t) + Derivative(τ(t), t))*cos(ε(t))*Derivative(δ(t), t) - 0.666666666666667*M*R**2*(sin(ε(t))*cos(τ(t))*Derivative(δ(t), t) + sin(τ(t))*Derivative(ε(t), t))*cos(ε(t))*cos(τ(t))*Derivative(δ(t), t) + 0.666666666666667*M*R**2*(sin(ε(t))*cos(τ(t))*Derivative(δ(t), t) + sin(τ(t))*Derivative(ε(t), t))*cos(τ(t))*Derivative(τ(t), t) - 0.666666666666667*M*R**2*(-sin(τ(t))*cos(ε(t))*Derivative(δ(t), t) + cos(τ(t))*Derivative(ε(t), t))*sin(ε(t))*sin(τ(t))*Derivative(δ(t), t) - 0.666666666666667*M*R**2*(-sin(τ(t))*cos(ε(t))*Derivative(δ(t), t) + cos(τ(t))*Derivative(ε(t), t))*sin(τ(t))*Derivative(τ(t), t) + 0.666666666666667*M*R**2*(sin(ε(t))*sin(τ(t))*Derivative(δ(t), t)*Derivative(ε(t), t) - sin(τ(t))*cos(ε(t))*Derivative(δ(t), (t, 2)) - sin(τ(t))*Derivative(ε(t), t)*Derivative(τ(t), t) - cos(ε(t))*cos(τ(t))*Derivative(δ(t), t)*Derivative(τ(t), t) + cos(τ(t))*Derivative(ε(t), (t, 2)))*cos(τ(t)) + 0.666666666666667*M*R**2*(-sin(ε(t))*sin(τ(t))*Derivative(δ(t), t)*Derivative(τ(t), t) + sin(ε(t))*cos(τ(t))*Derivative(δ(t), (t, 2)) + sin(τ(t))*Derivative(ε(t), (t, 2)) + cos(ε(t))*cos(τ(t))*Derivative(δ(t), t)*Derivative(ε(t), t) + cos(τ(t))*Derivative(ε(t), t)*Derivative(τ(t), t))*sin(τ(t)) - 0.5*M_p*R_p**2*(sin(ε(t))*cos(τ(t))*Derivative(δ(t), t) + sin(τ(t))*Derivative(ε(t), t))*cos(ε(t))*cos(τ(t))*Derivative(δ(t), t) + 0.5*M_p*R_p**2*(sin(ε(t))*cos(τ(t))*Derivative(δ(t), t) + sin(τ(t))*Derivative(ε(t), t))*cos(τ(t))*Derivative(τ(t), t) + 0.5*M_p*R_p**2*(-sin(ε(t))*sin(τ(t))*Derivative(δ(t), t)*Derivative(τ(t), t) + sin(ε(t))*cos(τ(t))*Derivative(δ(t), (t, 2)) + sin(τ(t))*Derivative(ε(t), (t, 2)) + cos(ε(t))*cos(τ(t))*Derivative(δ(t), t)*Derivative(ε(t), t) + cos(τ(t))*Derivative(ε(t), t)*Derivative(τ(t), t))*sin(τ(t)) + R*λ2*cos(τ(t)) - R*λ3*sin(δ(t))*cos(β(t))*cos(γ(t)) + R*λ4*cos(β(t))*cos(γ(t))*cos(δ(t))"
Eq10_str = "-0.333333333333333*M*R**2*(-2*sin(τ(t))*Derivative(ε(t), t) - 2*cos(ε(t))*cos(τ(t))*Derivative(δ(t), t))*(-sin(τ(t))*cos(ε(t))*Derivative(δ(t), t) + cos(τ(t))*Derivative(ε(t), t)) - 0.333333333333333*M*R**2*(-2*sin(ε(t))*sin(τ(t))*Derivative(δ(t), t) + 2*cos(τ(t))*Derivative(ε(t), t))*(sin(ε(t))*cos(τ(t))*Derivative(δ(t), t) + sin(τ(t))*Derivative(ε(t), t)) + 0.333333333333333*M*R**2*(2*sin(ε(t))*Derivative(δ(t), (t, 2)) + 2*cos(ε(t))*Derivative(δ(t), t)*Derivative(ε(t), t) + 2*Derivative(τ(t), (t, 2))) - 0.25*M_p*R_p**2*(-2*sin(ε(t))*sin(τ(t))*Derivative(δ(t), t) + 2*cos(τ(t))*Derivative(ε(t), t))*(sin(ε(t))*cos(τ(t))*Derivative(δ(t), t) + sin(τ(t))*Derivative(ε(t), t)) + R*λ1 - R*λ3*(-sin(α(t))*sin(γ(t))*sin(ε(t)) + sin(β(t))*sin(ε(t))*cos(α(t))*cos(γ(t)) + cos(β(t))*cos(γ(t))*cos(δ(t))*cos(ε(t))) - R*λ4*(sin(α(t))*sin(β(t))*sin(ε(t))*cos(γ(t)) + sin(γ(t))*sin(ε(t))*cos(α(t)) + sin(δ(t))*cos(β(t))*cos(γ(t))*cos(ε(t)))"

t1 = time.time()

Eq6 = -M_φ + 0.5*m*(2*C_mz*(sin(x1)*cos(x3) + sin(x2)*sin(x3)*cos(x1))*sin(x5) - 2*C_mz*cos(x1)*cos(x2)*cos(x5))*(C_mz*(sin(x1)*cos(x3) + sin(x2)*sin(x3)*cos(x1))*(sin(x2)*diff(diff(x1, t), t) + sin(x5)*diff(diff(x4, t), t) + cos(x2)*diff(x1, t)*diff(x2, t) + cos(x5)*diff(x4, t)*diff(x5, t) + diff(diff(x3, t), t)) + C_mz*(sin(x2)*diff(x1, t) + sin(x5)*diff(x4, t) + diff(x3, t))*(-sin(x1)*sin(x2)*sin(x3)*diff(x1, t) - sin(x1)*sin(x3)*diff(x3, t) + sin(x2)*cos(x1)*cos(x3)*diff(x3, t) + sin(x3)*cos(x1)*cos(x2)*diff(x2, t) + cos(x1)*cos(x3)*diff(x1, t)) + C_mz*(-sin(x3)*cos(x2)*diff(x1, t) + cos(x3)*diff(x2, t) + cos(x5)*diff(x4, t))*sin(x1)*cos(x2)*diff(x1, t) + C_mz*(-sin(x3)*cos(x2)*diff(x1, t) + cos(x3)*diff(x2, t) + cos(x5)*diff(x4, t))*sin(x2)*cos(x1)*diff(x2, t) - C_mz*(sin(x2)*sin(x3)*diff(x1, t)*diff(x2, t) - sin(x3)*cos(x2)*diff(diff(x1, t), t) - sin(x3)*diff(x2, t)*diff(x3, t) - sin(x5)*diff(x4, t)*diff(x5, t) - cos(x2)*cos(x3)*diff(x1, t)*diff(x3, t) + cos(x3)*diff(diff(x2, t), t) + cos(x5)*diff(diff(x4, t), t))*cos(x1)*cos(x2) + diff(diff(y, t), t)) + 0.5*m*(2*C_mz*(-sin(x1)*sin(x2)*sin(x3) + cos(x1)*cos(x3))*sin(x5) + 2*C_mz*sin(x1)*cos(x2)*cos(x5))*(C_mz*(-sin(x1)*sin(x2)*sin(x3) + cos(x1)*cos(x3))*(sin(x2)*diff(diff(x1, t), t) + sin(x5)*diff(diff(x4, t), t) + cos(x2)*diff(x1, t)*diff(x2, t) + cos(x5)*diff(x4, t)*diff(x5, t) + diff(diff(x3, t), t)) + C_mz*(sin(x2)*diff(x1, t) + sin(x5)*diff(x4, t) + diff(x3, t))*(-sin(x1)*sin(x2)*cos(x3)*diff(x3, t) - sin(x1)*sin(x3)*cos(x2)*diff(x2, t) - sin(x1)*cos(x3)*diff(x1, t) - sin(x2)*sin(x3)*cos(x1)*diff(x1, t) - sin(x3)*cos(x1)*diff(x3, t)) - C_mz*(-sin(x3)*cos(x2)*diff(x1, t) + cos(x3)*diff(x2, t) + cos(x5)*diff(x4, t))*sin(x1)*sin(x2)*diff(x2, t) + C_mz*(-sin(x3)*cos(x2)*diff(x1, t) + cos(x3)*diff(x2, t) + cos(x5)*diff(x4, t))*cos(x1)*cos(x2)*diff(x1, t) + C_mz*(sin(x2)*sin(x3)*diff(x1, t)*diff(x2, t) - sin(x3)*cos(x2)*diff(diff(x1, t), t) - sin(x3)*diff(x2, t)*diff(x3, t) - sin(x5)*diff(x4, t)*diff(x5, t) - cos(x2)*cos(x3)*diff(x1, t)*diff(x3, t) + cos(x3)*diff(diff(x2, t), t) + cos(x5)*diff(diff(x4, t), t))*sin(x1)*cos(x2) + diff(diff(x, t), t)) + 0.5*m*(-2*C_mz*sin(x2)*cos(x5) - 2*C_mz*sin(x3)*sin(x5)*cos(x2))*(C_mz*(sin(x2)*diff(x1, t) + sin(x5)*diff(x4, t) + diff(x3, t))*sin(x2)*sin(x3)*diff(x2, t) - C_mz*(sin(x2)*diff(x1, t) + sin(x5)*diff(x4, t) + diff(x3, t))*cos(x2)*cos(x3)*diff(x3, t) - C_mz*(-sin(x3)*cos(x2)*diff(x1, t) + cos(x3)*diff(x2, t) + cos(x5)*diff(x4, t))*cos(x2)*diff(x2, t) - C_mz*(sin(x2)*diff(diff(x1, t), t) + sin(x5)*diff(diff(x4, t), t) + cos(x2)*diff(x1, t)*diff(x2, t) + cos(x5)*diff(x4, t)*diff(x5, t) + diff(diff(x3, t), t))*sin(x3)*cos(x2) - C_mz*(sin(x2)*sin(x3)*diff(x1, t)*diff(x2, t) - sin(x3)*cos(x2)*diff(diff(x1, t), t) - sin(x3)*diff(x2, t)*diff(x3, t) - sin(x5)*diff(x4, t)*diff(x5, t) - cos(x2)*cos(x3)*diff(x1, t)*diff(x3, t) + cos(x3)*diff(diff(x2, t), t) + cos(x5)*diff(diff(x4, t), t))*sin(x2)) + 0.5*m*(-C_mz*(sin(x2)*diff(x1, t) + sin(x5)*diff(x4, t) + diff(x3, t))*sin(x3)*cos(x2) - C_mz*(-sin(x3)*cos(x2)*diff(x1, t) + cos(x3)*diff(x2, t) + cos(x5)*diff(x4, t))*sin(x2))*(2*C_mz*sin(x2)*sin(x3)*sin(x5)*diff(x2, t) + 2*C_mz*sin(x2)*sin(x5)*diff(x5, t) - 2*C_mz*sin(x3)*cos(x2)*cos(x5)*diff(x5, t) - 2*C_mz*sin(x5)*cos(x2)*cos(x3)*diff(x3, t) - 2*C_mz*cos(x2)*cos(x5)*diff(x2, t)) + 0.5*m*(C_mz*(sin(x1)*cos(x3) + sin(x2)*sin(x3)*cos(x1))*(sin(x2)*diff(x1, t) + sin(x5)*diff(x4, t) + diff(x3, t)) - C_mz*(-sin(x3)*cos(x2)*diff(x1, t) + cos(x3)*diff(x2, t) + cos(x5)*diff(x4, t))*cos(x1)*cos(x2) + diff(y, t))*(2*C_mz*(sin(x1)*cos(x3) + sin(x2)*sin(x3)*cos(x1))*cos(x5)*diff(x5, t) + 2*C_mz*(-sin(x1)*sin(x2)*sin(x3)*diff(x1, t) - sin(x1)*sin(x3)*diff(x3, t) + sin(x2)*cos(x1)*cos(x3)*diff(x3, t) + sin(x3)*cos(x1)*cos(x2)*diff(x2, t) + cos(x1)*cos(x3)*diff(x1, t))*sin(x5) + 2*C_mz*sin(x1)*cos(x2)*cos(x5)*diff(x1, t) + 2*C_mz*sin(x2)*cos(x1)*cos(x5)*diff(x2, t) + 2*C_mz*sin(x5)*cos(x1)*cos(x2)*diff(x5, t)) + 0.5*m*(C_mz*(-sin(x1)*sin(x2)*sin(x3) + cos(x1)*cos(x3))*(sin(x2)*diff(x1, t) + sin(x5)*diff(x4, t) + diff(x3, t)) + C_mz*(-sin(x3)*cos(x2)*diff(x1, t) + cos(x3)*diff(x2, t) + cos(x5)*diff(x4, t))*sin(x1)*cos(x2) + diff(x, t))*(2*C_mz*(-sin(x1)*sin(x2)*sin(x3) + cos(x1)*cos(x3))*cos(x5)*diff(x5, t) + 2*C_mz*(-sin(x1)*sin(x2)*cos(x3)*diff(x3, t) - sin(x1)*sin(x3)*cos(x2)*diff(x2, t) - sin(x1)*cos(x3)*diff(x1, t) - sin(x2)*sin(x3)*cos(x1)*diff(x1, t) - sin(x3)*cos(x1)*diff(x3, t))*sin(x5) - 2*C_mz*sin(x1)*sin(x2)*cos(x5)*diff(x2, t) - 2*C_mz*sin(x1)*sin(x5)*cos(x2)*diff(x5, t) + 2*C_mz*cos(x1)*cos(x2)*cos(x5)*diff(x1, t)) - r*λ3*(sin(x1)*sin(x2)*sin(x3)*sin(x5) - sin(x1)*cos(x2)*cos(x5) - sin(x5)*cos(x1)*cos(x3)) - r*λ4*(-sin(x1)*sin(x5)*cos(x3) - sin(x2)*sin(x3)*sin(x5)*cos(x1) + cos(x1)*cos(x2)*cos(x5)) + (1.0*l**2*m + 0.25*m*r**2)*(sin(x2)*diff(x1, t) + sin(x5)*diff(x4, t) + diff(x3, t))*cos(x5)*diff(x5, t) - (1.0*l**2*m + 0.25*m*r**2)*(-sin(x3)*cos(x2)*diff(x1, t) + cos(x3)*diff(x2, t) + cos(x5)*diff(x4, t))*sin(x5)*diff(x5, t) + (1.0*l**2*m + 0.25*m*r**2)*(sin(x2)*diff(diff(x1, t), t) + sin(x5)*diff(diff(x4, t), t) + cos(x2)*diff(x1, t)*diff(x2, t) + cos(x5)*diff(x4, t)*diff(x5, t) + diff(diff(x3, t), t))*sin(x5) + (1.0*l**2*m + 0.25*m*r**2)*(sin(x2)*sin(x3)*diff(x1, t)*diff(x2, t) - sin(x3)*cos(x2)*diff(diff(x1, t), t) - sin(x3)*diff(x2, t)*diff(x3, t) - sin(x5)*diff(x4, t)*diff(x5, t) - cos(x2)*cos(x3)*diff(x1, t)*diff(x3, t) + cos(x3)*diff(diff(x2, t), t) + cos(x5)*diff(diff(x4, t), t))*cos(x5)
Eq6 = expand_and_collect_term_before_derivatives_and_lambda(Eq6)

Eq8 = 0.666666666666667*M*R**2*(sin(x7)*diff(x6, t) + diff(x8, t))*cos(x7)*diff(x7, t) - 0.666666666666667*M*R**2*(sin(x7)*cos(x8)*diff(x6, t) + sin(x8)*diff(x7, t))*sin(x7)*sin(x8)*diff(x8, t) + 0.666666666666667*M*R**2*(sin(x7)*cos(x8)*diff(x6, t) + sin(x8)*diff(x7, t))*cos(x7)*cos(x8)*diff(x7, t) + 0.666666666666667*M*R**2*(-sin(x8)*cos(x7)*diff(x6, t) + cos(x8)*diff(x7, t))*sin(x7)*sin(x8)*diff(x7, t) - 0.666666666666667*M*R**2*(-sin(x8)*cos(x7)*diff(x6, t) + cos(x8)*diff(x7, t))*cos(x7)*cos(x8)*diff(x8, t) + 0.666666666666667*M*R**2*(sin(x7)*diff(diff(x6, t), t) + cos(x7)*diff(x6, t)*diff(x7, t) + diff(diff(x8, t), t))*sin(x7) - 0.666666666666667*M*R**2*(sin(x7)*sin(x8)*diff(x6, t)*diff(x7, t) - sin(x8)*cos(x7)*diff(diff(x6, t), t) - sin(x8)*diff(x7, t)*diff(x8, t) - cos(x7)*cos(x8)*diff(x6, t)*diff(x8, t) + cos(x8)*diff(diff(x7, t), t))*sin(x8)*cos(x7) + 0.666666666666667*M*R**2*(-sin(x7)*sin(x8)*diff(x6, t)*diff(x8, t) + sin(x7)*cos(x8)*diff(diff(x6, t), t) + sin(x8)*diff(diff(x7, t), t) + cos(x7)*cos(x8)*diff(x6, t)*diff(x7, t) + cos(x8)*diff(x7, t)*diff(x8, t))*sin(x7)*cos(x8) - 0.5*M_p*R_p**2*(sin(x7)*cos(x8)*diff(x6, t) + sin(x8)*diff(x7, t))*sin(x7)*sin(x8)*diff(x8, t) + 0.5*M_p*R_p**2*(sin(x7)*cos(x8)*diff(x6, t) + sin(x8)*diff(x7, t))*cos(x7)*cos(x8)*diff(x7, t) + 0.5*M_p*R_p**2*(-sin(x7)*sin(x8)*diff(x6, t)*diff(x8, t) + sin(x7)*cos(x8)*diff(diff(x6, t), t) + sin(x8)*diff(diff(x7, t), t) + cos(x7)*cos(x8)*diff(x6, t)*diff(x7, t) + cos(x8)*diff(x7, t)*diff(x8, t))*sin(x7)*cos(x8) + R*λ1*sin(x7) - R*λ2*sin(x8)*cos(x7) - R*λ3*(-sqrt(2)*sin(x7 + pi/4)*sin(x1)*sin(x3)*sin(x7)*cos(x8)**2 + sqrt(2)*sin(x7 + pi/4)*sin(x2)*sin(x7)*cos(x1)*cos(x3)*cos(x8)**2 + sin(x1)*sin(x3)*cos(x8)**2 - sin(x1)*sin(x3) - sin(x2)*cos(x1)*cos(x3)*cos(x8)**2 + sin(x2)*cos(x1)*cos(x3) - sqrt(2)*sin(x6)*sin(x8)*cos(x7 + pi/4)*cos(x2)*cos(x3)*cos(x8) + sqrt(2)*sin(x7)*cos(x7 + pi/4)*cos(x2)*cos(x3)*cos(x6)*cos(x8)**2) - R*λ4*(sqrt(2)*sin(x7 + pi/4)*sin(x1)*sin(x2)*sin(x7)*cos(x3)*cos(x8)**2 + sqrt(2)*sin(x7 + pi/4)*sin(x3)*sin(x7)*cos(x1)*cos(x8)**2 - sin(x1)*sin(x2)*cos(x3)*cos(x8)**2 + sin(x1)*sin(x2)*cos(x3) - sin(x3)*cos(x1)*cos(x8)**2 + sin(x3)*cos(x1) + sqrt(2)*sin(x6)*sin(x7)*cos(x7 + pi/4)*cos(x2)*cos(x3)*cos(x8)**2 + sqrt(2)*sin(x8)*cos(x7 + pi/4)*cos(x2)*cos(x3)*cos(x6)*cos(x8))
Eq8 = expand_and_collect_term_before_derivatives_and_lambda(Eq8)

Eq9 = -0.666666666666667*M*R**2*(sin(x7)*diff(x6, t) + diff(x8, t))*cos(x7)*diff(x6, t) - 0.666666666666667*M*R**2*(sin(x7)*cos(x8)*diff(x6, t) + sin(x8)*diff(x7, t))*cos(x7)*cos(x8)*diff(x6, t) + 0.666666666666667*M*R**2*(sin(x7)*cos(x8)*diff(x6, t) + sin(x8)*diff(x7, t))*cos(x8)*diff(x8, t) - 0.666666666666667*M*R**2*(-sin(x8)*cos(x7)*diff(x6, t) + cos(x8)*diff(x7, t))*sin(x7)*sin(x8)*diff(x6, t) - 0.666666666666667*M*R**2*(-sin(x8)*cos(x7)*diff(x6, t) + cos(x8)*diff(x7, t))*sin(x8)*diff(x8, t) + 0.666666666666667*M*R**2*(sin(x7)*sin(x8)*diff(x6, t)*diff(x7, t) - sin(x8)*cos(x7)*diff(diff(x6, t), t) - sin(x8)*diff(x7, t)*diff(x8, t) - cos(x7)*cos(x8)*diff(x6, t)*diff(x8, t) + cos(x8)*diff(diff(x7, t), t))*cos(x8) + 0.666666666666667*M*R**2*(-sin(x7)*sin(x8)*diff(x6, t)*diff(x8, t) + sin(x7)*cos(x8)*diff(diff(x6, t), t) + sin(x8)*diff(diff(x7, t), t) + cos(x7)*cos(x8)*diff(x6, t)*diff(x7, t) + cos(x8)*diff(x7, t)*diff(x8, t))*sin(x8) - 0.5*M_p*R_p**2*(sin(x7)*cos(x8)*diff(x6, t) + sin(x8)*diff(x7, t))*cos(x7)*cos(x8)*diff(x6, t) + 0.5*M_p*R_p**2*(sin(x7)*cos(x8)*diff(x6, t) + sin(x8)*diff(x7, t))*cos(x8)*diff(x8, t) + 0.5*M_p*R_p**2*(-sin(x7)*sin(x8)*diff(x6, t)*diff(x8, t) + sin(x7)*cos(x8)*diff(diff(x6, t), t) + sin(x8)*diff(diff(x7, t), t) + cos(x7)*cos(x8)*diff(x6, t)*diff(x7, t) + cos(x8)*diff(x7, t)*diff(x8, t))*sin(x8) + R*λ2*cos(x8) - R*λ3*sin(x6)*cos(x2)*cos(x3) + R*λ4*cos(x2)*cos(x3)*cos(x6)
Eq9 = expand_and_collect_term_before_derivatives_and_lambda(Eq9)

Eq10 = -0.333333333333333*M*R**2*(-2*sin(x8)*diff(x7, t) - 2*cos(x7)*cos(x8)*diff(x6, t))*(-sin(x8)*cos(x7)*diff(x6, t) + cos(x8)*diff(x7, t)) - 0.333333333333333*M*R**2*(-2*sin(x7)*sin(x8)*diff(x6, t) + 2*cos(x8)*diff(x7, t))*(sin(x7)*cos(x8)*diff(x6, t) + sin(x8)*diff(x7, t)) + 0.333333333333333*M*R**2*(2*sin(x7)*diff(diff(x6, t), t) + 2*cos(x7)*diff(x6, t)*diff(x7, t) + 2*diff(diff(x8, t), t)) - 0.25*M_p*R_p**2*(-2*sin(x7)*sin(x8)*diff(x6, t) + 2*cos(x8)*diff(x7, t))*(sin(x7)*cos(x8)*diff(x6, t) + sin(x8)*diff(x7, t)) + R*λ1 - R*λ3*(-sin(x1)*sin(x3)*sin(x7) + sin(x2)*sin(x7)*cos(x1)*cos(x3) + cos(x2)*cos(x3)*cos(x6)*cos(x7)) - R*λ4*(sin(x1)*sin(x2)*sin(x7)*cos(x3) + sin(x3)*sin(x7)*cos(x1) + sin(x6)*cos(x2)*cos(x3)*cos(x7))
Eq10 = expand_and_collect_term_before_derivatives_and_lambda(Eq10)

print("Eq6 ", Eq6)
print("Eq8 ", Eq8)
print("Eq9 ", Eq9)
print("Eq10 ", Eq10)

(A, b) = linear_eq_to_matrix([Eq6, Eq8, Eq9, Eq10], [λ1, λ2, λ3, λ4])

A_inv = A.inv()
print("inv A = ", A_inv)

solution = A_inv * b
lambda1 = solution.row(0)[0]
lambda2 = solution.row(1)[0]
lambda3 = solution.row(2)[0]
lambda4 = solution.row(3)[0]

λ_1_top, λ_1_bottom = fraction(together(lambda1))
λ_2_top, λ_2_bottom = fraction(together(lambda2))
λ_3_top, λ_3_bottom = fraction(together(lambda3))
λ_4_top, λ_4_bottom = fraction(together(lambda4))

λ_1_top = expand_and_collect_term_before_derivatives_and_lambda(λ_1_top)
λ_1_bottom = expand_and_collect_term_before_derivatives_and_lambda(λ_1_bottom)
print("λ_1_top ", λ_1_top)
print("λ_1_bot ", λ_1_bottom)

print("\n----------\n")

λ_2_top = expand_and_collect_term_before_derivatives_and_lambda(λ_2_top)
λ_2_bottom = expand_and_collect_term_before_derivatives_and_lambda(λ_2_bottom)
print("λ_2_top ", λ_2_top)
print("λ_2_bot ", λ_2_bottom)

print("\n----------\n")

λ_3_top = expand_and_collect_term_before_derivatives_and_lambda(λ_3_top)
λ_3_bottom = expand_and_collect_term_before_derivatives_and_lambda(λ_3_bottom)
print("λ_3_top ", λ_3_top)
print("λ_3_bot ", λ_3_bottom)

print("\n----------\n")

λ_4_top = expand_and_collect_term_before_derivatives_and_lambda(λ_4_top)
λ_4_bottom = expand_and_collect_term_before_derivatives_and_lambda(λ_4_bottom)
print("λ_4_top ", λ_4_top)
print("λ_4_bot ", λ_4_bottom)

t2 = time.time()

print("\n----------\n")

print("total time: ", round((t2-t1)/60, 2), " min")